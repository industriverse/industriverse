{"version":3,"file":"CapsuleAPI.js","sourceRoot":"","sources":["CapsuleAPI.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Capsule Gateway API Service\n * \n * REST API client for Capsule Gateway Service\n */\n\nimport type { CapsuleData, CapsuleAction } from '@/types/capsule';\n\nexport interface APIConfig {\n  baseUrl: string;\n  authToken?: string;\n}\n\nexport interface ActionRequest {\n  capsuleId: string;\n  action: CapsuleAction;\n  userId?: string;\n  metadata?: Record<string, any>;\n}\n\nexport interface ActionResponse {\n  success: boolean;\n  capsuleId: string;\n  action: CapsuleAction;\n  timestamp: string;\n  message?: string;\n}\n\nexport class CapsuleAPI {\n  private config: Required<APIConfig>;\n\n  constructor(config: APIConfig) {\n    this.config = {\n      baseUrl: config.baseUrl,\n      authToken: config.authToken || ''\n    };\n  }\n\n  /**\n   * Get all capsules\n   */\n  async getCapsules(): Promise<CapsuleData[]> {\n    const response = await this.fetch('/api/v1/capsules');\n    return response.json();\n  }\n\n  /**\n   * Get capsule by ID\n   */\n  async getCapsule(id: string): Promise<CapsuleData> {\n    const response = await this.fetch(`/api/v1/capsules/${id}`);\n    return response.json();\n  }\n\n  /**\n   * Execute action on capsule\n   */\n  async executeAction(request: ActionRequest): Promise<ActionResponse> {\n    const response = await this.fetch('/api/v1/capsule/action', {\n      method: 'POST',\n      body: JSON.stringify(request)\n    });\n    return response.json();\n  }\n\n  /**\n   * Get capsule statistics\n   */\n  async getStatistics(): Promise<{\n    total: number;\n    active: number;\n    warning: number;\n    critical: number;\n    resolved: number;\n    dismissed: number;\n  }> {\n    const response = await this.fetch('/api/v1/capsules/statistics');\n    return response.json();\n  }\n\n  /**\n   * Update auth token\n   */\n  updateAuthToken(token: string): void {\n    this.config.authToken = token;\n  }\n\n  /**\n   * Internal fetch wrapper with auth and error handling\n   */\n  private async fetch(path: string, options: RequestInit = {}): Promise<Response> {\n    const url = `${this.config.baseUrl}${path}`;\n    \n    const headers: Record<string, string> = {\n      'Content-Type': 'application/json',\n      ...(options.headers as Record<string, string> || {})\n    };\n\n    if (this.config.authToken) {\n      headers['Authorization'] = `Bearer ${this.config.authToken}`;\n    }\n\n    try {\n      const response = await fetch(url, {\n        ...options,\n        headers\n      });\n\n      if (!response.ok) {\n        const error = await response.json().catch(() => ({\n          message: response.statusText\n        }));\n        throw new Error(error.message || `HTTP ${response.status}`);\n      }\n\n      return response;\n    } catch (error) {\n      if (error instanceof TypeError) {\n        throw new Error('Network error: Unable to reach server');\n      }\n      throw error;\n    }\n  }\n}\n\n// Create singleton instance\nlet apiInstance: CapsuleAPI | null = null;\n\n/**\n * Get API instance\n */\nexport function getAPI(): CapsuleAPI {\n  if (!apiInstance) {\n    const baseUrl = import.meta.env.VITE_CAPSULE_GATEWAY_API || 'https://capsule-gateway.industriverse.io';\n    const authToken = import.meta.env.VITE_AUTH_TOKEN || '';\n    \n    apiInstance = new CapsuleAPI({\n      baseUrl,\n      authToken\n    });\n  }\n  \n  return apiInstance;\n}\n\n/**\n * Update API auth token\n */\nexport function updateAPIToken(token: string): void {\n  getAPI().updateAuthToken(token);\n}\n"]}