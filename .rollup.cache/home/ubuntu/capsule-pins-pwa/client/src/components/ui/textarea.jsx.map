{"version":3,"file":"textarea.jsx","sourceRoot":"","sources":["textarea.tsx"],"names":[],"mappings":";AAAA,OAAO,EAAE,oBAAoB,EAAE,MAAM,wBAAwB,CAAC;AAC9D,OAAO,EAAE,cAAc,EAAE,MAAM,wBAAwB,CAAC;AACxD,OAAO,EAAE,EAAE,EAAE,MAAM,aAAa,CAAC;AACjC,OAAO,KAAK,KAAK,MAAM,OAAO,CAAC;AAE/B,SAAS,QAAQ,CAAC,EAMiB;IALjC,IAAA,SAAS,eAAA,EACT,SAAS,eAAA,EACT,kBAAkB,wBAAA,EAClB,gBAAgB,sBAAA,EACb,KAAK,cALQ,oEAMjB,CADS;IAER,mFAAmF;IACnF,IAAM,iBAAiB,GAAG,oBAAoB,EAAE,CAAC;IAEjD,yFAAyF;IACnF,IAAA,KAIF,cAAc,CAAsB;QACtC,SAAS,EAAE,UAAC,CAAC;YACX,uDAAuD;YACvD,IAAM,WAAW,GAAI,CAAC,CAAC,WAAmB,CAAC,WAAW,IAAI,iBAAiB,CAAC,kBAAkB,EAAE,CAAC;YAEjG,2EAA2E;YAC3E,mEAAmE;YACnE,iEAAiE;YACjE,IAAI,CAAC,CAAC,GAAG,KAAK,OAAO,IAAI,CAAC,CAAC,CAAC,QAAQ,IAAI,WAAW,EAAE,CAAC;gBACpD,OAAO;YACT,CAAC;YAED,uCAAuC;YACvC,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAG,CAAC,CAAC,CAAC;QACjB,CAAC;QACD,kBAAkB,EAAE,UAAA,CAAC;YACnB,iBAAiB,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;YACrC,kBAAkB,aAAlB,kBAAkB,uBAAlB,kBAAkB,CAAG,CAAC,CAAC,CAAC;QAC1B,CAAC;QACD,gBAAgB,EAAE,UAAA,CAAC;YACjB,yFAAyF;YACzF,iBAAiB,CAAC,kBAAkB,EAAE,CAAC;YACvC,kEAAkE;YAClE,+DAA+D;YAC/D,UAAU,CAAC;gBACT,iBAAiB,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;YACxC,CAAC,EAAE,GAAG,CAAC,CAAC;YACR,gBAAgB,aAAhB,gBAAgB,uBAAhB,gBAAgB,CAAG,CAAC,CAAC,CAAC;QACxB,CAAC;KACF,CAAC,EAhCoB,sBAAsB,wBAAA,EACxB,oBAAoB,sBAAA,EAC3B,aAAa,eA8BxB,CAAC;IAEH,OAAO,CACL,CAAC,QAAQ,CACP,SAAS,CAAC,UAAU,CACpB,SAAS,CAAC,CAAC,EAAE,CACX,qcAAqc,EACrc,SAAS,CACV,CAAC,CACF,kBAAkB,CAAC,CAAC,sBAAsB,CAAC,CAC3C,gBAAgB,CAAC,CAAC,oBAAoB,CAAC,CACvC,SAAS,CAAC,CAAC,aAAa,CAAC,CACzB,IAAI,KAAK,CAAC,EACV,CACH,CAAC;AACJ,CAAC;AAED,OAAO,EAAE,QAAQ,EAAE,CAAC","sourcesContent":["import { useDialogComposition } from \"@/components/ui/dialog\";\nimport { useComposition } from \"@/hooks/useComposition\";\nimport { cn } from \"@/lib/utils\";\nimport * as React from \"react\";\n\nfunction Textarea({\n  className,\n  onKeyDown,\n  onCompositionStart,\n  onCompositionEnd,\n  ...props\n}: React.ComponentProps<\"textarea\">) {\n  // Get dialog composition context if available (will be no-op if not inside Dialog)\n  const dialogComposition = useDialogComposition();\n\n  // Add composition event handlers to support input method editor (IME) for CJK languages.\n  const {\n    onCompositionStart: handleCompositionStart,\n    onCompositionEnd: handleCompositionEnd,\n    onKeyDown: handleKeyDown,\n  } = useComposition<HTMLTextAreaElement>({\n    onKeyDown: (e) => {\n      // Check if this is an Enter key that should be blocked\n      const isComposing = (e.nativeEvent as any).isComposing || dialogComposition.justEndedComposing();\n\n      // If Enter key is pressed while composing or just after composition ended,\n      // don't call the user's onKeyDown (this blocks the business logic)\n      // Note: For textarea, Shift+Enter should still work for newlines\n      if (e.key === \"Enter\" && !e.shiftKey && isComposing) {\n        return;\n      }\n\n      // Otherwise, call the user's onKeyDown\n      onKeyDown?.(e);\n    },\n    onCompositionStart: e => {\n      dialogComposition.setComposing(true);\n      onCompositionStart?.(e);\n    },\n    onCompositionEnd: e => {\n      // Mark that composition just ended - this helps handle the Enter key that confirms input\n      dialogComposition.markCompositionEnd();\n      // Delay setting composing to false to handle Safari's event order\n      // In Safari, compositionEnd fires before the ESC keydown event\n      setTimeout(() => {\n        dialogComposition.setComposing(false);\n      }, 100);\n      onCompositionEnd?.(e);\n    },\n  });\n\n  return (\n    <textarea\n      data-slot=\"textarea\"\n      className={cn(\n        \"border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      onCompositionStart={handleCompositionStart}\n      onCompositionEnd={handleCompositionEnd}\n      onKeyDown={handleKeyDown}\n      {...props}\n    />\n  );\n}\n\nexport { Textarea };\n"]}