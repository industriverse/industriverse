{"version":3,"file":"iv-energy-gauge.js","sourceRoot":"","sources":["iv-energy-gauge.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * <iv-energy-gauge> Widget\n * Week 8: White-Label Platform\n * \n * Real-time energy consumption gauge with threshold indicators\n * Features:\n * - Circular gauge with animated needle\n * - Color-coded zones (green/yellow/red)\n * - Current/peak/average values\n * - WebSocket updates\n * - AmI glow effects\n */\n\nimport { IVWidget } from './base/IVWidget';\n\ninterface EnergyData {\n  current: number;\n  peak: number;\n  average: number;\n  unit: string;\n  timestamp: number;\n  threshold_warning: number;\n  threshold_critical: number;\n}\n\nexport class IVEnergyGauge extends IVWidget {\n  protected attachEventListeners(): void {\n    // No DOM event listeners needed for gauge\n  }\n  protected energyData: EnergyData = {\n    current: 0,\n    peak: 0,\n    average: 0,\n    unit: 'kW',\n    timestamp: Date.now(),\n    threshold_warning: 75,\n    threshold_critical: 90,\n  };\n\n  protected canvas: HTMLCanvasElement | null = null;\n  protected ctx: CanvasRenderingContext2D | null = null;\n  protected animationFrame: number | null = null;\n  protected targetValue: number = 0;\n  protected currentValue: number = 0;\n\n  constructor() {\n    super();\n    this.setupCanvas();\n  }\n\n  protected setupCanvas() {\n    this.canvas = document.createElement('canvas');\n    this.canvas.width = 300;\n    this.canvas.height = 300;\n    this.ctx = this.canvas.getContext('2d');\n  }\n\n  protected getDefaultStyles(): string {\n    return `\n      :host {\n        display: block;\n        width: 300px;\n        height: 400px;\n        font-family: var(--font-sans, system-ui, sans-serif);\n      }\n\n      .gauge-container {\n        background: var(--color-background, #1a1a1a);\n        border: 1px solid var(--color-border, #333);\n        border-radius: 12px;\n        padding: 20px;\n        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);\n        transition: all 0.3s ease;\n      }\n\n      .gauge-container:hover {\n        box-shadow: 0 8px 12px rgba(0, 0, 0, 0.4);\n      }\n\n      .gauge-title {\n        font-size: 14px;\n        font-weight: 600;\n        color: var(--color-foreground, #e5e5e5);\n        margin-bottom: 16px;\n        text-align: center;\n      }\n\n      .gauge-canvas {\n        display: block;\n        margin: 0 auto;\n      }\n\n      .gauge-stats {\n        display: grid;\n        grid-template-columns: repeat(3, 1fr);\n        gap: 12px;\n        margin-top: 16px;\n      }\n\n      .stat {\n        text-align: center;\n      }\n\n      .stat-label {\n        font-size: 11px;\n        color: var(--color-muted-foreground, #888);\n        text-transform: uppercase;\n        letter-spacing: 0.5px;\n      }\n\n      .stat-value {\n        font-size: 18px;\n        font-weight: 700;\n        color: var(--color-foreground, #e5e5e5);\n        margin-top: 4px;\n      }\n\n      .stat-unit {\n        font-size: 12px;\n        color: var(--color-muted-foreground, #888);\n        margin-left: 2px;\n      }\n\n      /* AmI glow effects */\n      .gauge-container.warning {\n        box-shadow: 0 0 20px rgba(251, 191, 36, 0.3);\n      }\n\n      .gauge-container.critical {\n        box-shadow: 0 0 20px rgba(239, 68, 68, 0.3);\n        animation: pulse-critical 2s ease-in-out infinite;\n      }\n\n      @keyframes pulse-critical {\n        0%, 100% {\n          box-shadow: 0 0 20px rgba(239, 68, 68, 0.3);\n        }\n        50% {\n          box-shadow: 0 0 30px rgba(239, 68, 68, 0.5);\n        }\n      }\n    `;\n  }\n\n  protected render(): void {\n    if (!this.shadowRoot) return;\n\n    const percentage = (this.energyData.current / this.energyData.peak) * 100;\n    let statusClass = '';\n    if (percentage >= this.energyData.threshold_critical) {\n      statusClass = 'critical';\n    } else if (percentage >= this.energyData.threshold_warning) {\n      statusClass = 'warning';\n    }\n\n    this.shadowRoot.innerHTML = `\n      <style>${this.getDefaultStyles()}</style>\n      <div class=\"gauge-container ${statusClass}\">\n        <div class=\"gauge-title\">Energy Consumption</div>\n        <canvas class=\"gauge-canvas\" width=\"300\" height=\"300\"></canvas>\n        <div class=\"gauge-stats\">\n          <div class=\"stat\">\n            <div class=\"stat-label\">Current</div>\n            <div class=\"stat-value\">\n              ${this.energyData.current.toFixed(1)}\n              <span class=\"stat-unit\">${this.energyData.unit}</span>\n            </div>\n          </div>\n          <div class=\"stat\">\n            <div class=\"stat-label\">Peak</div>\n            <div class=\"stat-value\">\n              ${this.energyData.peak.toFixed(1)}\n              <span class=\"stat-unit\">${this.energyData.unit}</span>\n            </div>\n          </div>\n          <div class=\"stat\">\n            <div class=\"stat-label\">Average</div>\n            <div class=\"stat-value\">\n              ${this.energyData.average.toFixed(1)}\n              <span class=\"stat-unit\">${this.energyData.unit}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    `;\n\n    // Get canvas from shadow DOM\n    this.canvas = this.shadowRoot.querySelector('.gauge-canvas');\n    if (this.canvas) {\n      this.ctx = this.canvas.getContext('2d');\n      this.drawGauge();\n    }\n  }\n\n  protected drawGauge(): void {\n    if (!this.ctx || !this.canvas) return;\n\n    const width = this.canvas.width;\n    const height = this.canvas.height;\n    const centerX = width / 2;\n    const centerY = height / 2;\n    const radius = Math.min(width, height) / 2 - 40;\n\n    // Clear canvas\n    this.ctx.clearRect(0, 0, width, height);\n\n    // Animate current value towards target\n    const diff = this.targetValue - this.currentValue;\n    if (Math.abs(diff) > 0.1) {\n      this.currentValue += diff * 0.1;\n      this.animationFrame = requestAnimationFrame(() => this.drawGauge());\n    } else {\n      this.currentValue = this.targetValue;\n    }\n\n    // Draw gauge background\n    this.ctx.beginPath();\n    this.ctx.arc(centerX, centerY, radius, 0.75 * Math.PI, 2.25 * Math.PI);\n    this.ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';\n    this.ctx.lineWidth = 20;\n    this.ctx.stroke();\n\n    // Draw colored zones\n    const warningAngle = 0.75 * Math.PI + (this.energyData.threshold_warning / 100) * 1.5 * Math.PI;\n    const criticalAngle = 0.75 * Math.PI + (this.energyData.threshold_critical / 100) * 1.5 * Math.PI;\n\n    // Green zone (0 - warning)\n    this.ctx.beginPath();\n    this.ctx.arc(centerX, centerY, radius, 0.75 * Math.PI, warningAngle);\n    this.ctx.strokeStyle = 'rgba(34, 197, 94, 0.3)';\n    this.ctx.lineWidth = 20;\n    this.ctx.stroke();\n\n    // Yellow zone (warning - critical)\n    this.ctx.beginPath();\n    this.ctx.arc(centerX, centerY, radius, warningAngle, criticalAngle);\n    this.ctx.strokeStyle = 'rgba(251, 191, 36, 0.3)';\n    this.ctx.lineWidth = 20;\n    this.ctx.stroke();\n\n    // Red zone (critical - max)\n    this.ctx.beginPath();\n    this.ctx.arc(centerX, centerY, radius, criticalAngle, 2.25 * Math.PI);\n    this.ctx.strokeStyle = 'rgba(239, 68, 68, 0.3)';\n    this.ctx.lineWidth = 20;\n    this.ctx.stroke();\n\n    // Draw current value arc\n    const percentage = this.currentValue / 100;\n    const endAngle = 0.75 * Math.PI + percentage * 1.5 * Math.PI;\n\n    let arcColor = '#22c55e'; // green\n    if (percentage >= this.energyData.threshold_critical / 100) {\n      arcColor = '#ef4444'; // red\n    } else if (percentage >= this.energyData.threshold_warning / 100) {\n      arcColor = '#fbbf24'; // yellow\n    }\n\n    this.ctx.beginPath();\n    this.ctx.arc(centerX, centerY, radius, 0.75 * Math.PI, endAngle);\n    this.ctx.strokeStyle = arcColor;\n    this.ctx.lineWidth = 20;\n    this.ctx.lineCap = 'round';\n    this.ctx.stroke();\n\n    // Draw needle\n    const needleAngle = 0.75 * Math.PI + percentage * 1.5 * Math.PI;\n    const needleLength = radius - 30;\n\n    this.ctx.save();\n    this.ctx.translate(centerX, centerY);\n    this.ctx.rotate(needleAngle);\n\n    // Needle shadow\n    this.ctx.beginPath();\n    this.ctx.moveTo(0, 0);\n    this.ctx.lineTo(needleLength + 2, 2);\n    this.ctx.strokeStyle = 'rgba(0, 0, 0, 0.3)';\n    this.ctx.lineWidth = 3;\n    this.ctx.stroke();\n\n    // Needle\n    this.ctx.beginPath();\n    this.ctx.moveTo(0, 0);\n    this.ctx.lineTo(needleLength, 0);\n    this.ctx.strokeStyle = '#e5e5e5';\n    this.ctx.lineWidth = 3;\n    this.ctx.stroke();\n\n    this.ctx.restore();\n\n    // Draw center circle\n    this.ctx.beginPath();\n    this.ctx.arc(centerX, centerY, 8, 0, 2 * Math.PI);\n    this.ctx.fillStyle = '#e5e5e5';\n    this.ctx.fill();\n\n    // Draw percentage text\n    this.ctx.font = 'bold 32px system-ui';\n    this.ctx.fillStyle = '#e5e5e5';\n    this.ctx.textAlign = 'center';\n    this.ctx.textBaseline = 'middle';\n    this.ctx.fillText(`${Math.round(percentage * 100)}%`, centerX, centerY + 60);\n  }\n\n  protected handleWebSocketMessage(data: any): void {\n    if (data.type === 'energy_update') {\n      this.updateEnergy(data.data);\n    }\n  }\n\n  public updateEnergy(data: Partial<EnergyData>): void {\n    this.energyData = { ...this.energyData, ...data };\n    this.targetValue = (this.energyData.current / this.energyData.peak) * 100;\n    this.render();\n    this.emitEvent('energy-update', this.energyData);\n  }\n\n  protected onConnect(): void {\n    this.render();\n  }\n\n  protected onDisconnect(): void {\n    if (this.animationFrame) {\n      cancelAnimationFrame(this.animationFrame);\n    }\n  }\n\n  // Attribute handling\n  static get observedAttributes() {\n    return ['current', 'peak', 'average', 'unit', 'threshold-warning', 'threshold-critical', 'ws-url', 'auto-connect'];\n  }\n\n  attributeChangedCallback(name: string, oldValue: string, newValue: string) {\n    if (oldValue === newValue) return;\n\n    switch (name) {\n      case 'current':\n        this.energyData.current = parseFloat(newValue) || 0;\n        this.targetValue = (this.energyData.current / this.energyData.peak) * 100;\n        this.render();\n        break;\n      case 'peak':\n        this.energyData.peak = parseFloat(newValue) || 100;\n        this.render();\n        break;\n      case 'average':\n        this.energyData.average = parseFloat(newValue) || 0;\n        this.render();\n        break;\n      case 'unit':\n        this.energyData.unit = newValue;\n        this.render();\n        break;\n      case 'threshold-warning':\n        this.energyData.threshold_warning = parseFloat(newValue) || 75;\n        this.render();\n        break;\n      case 'threshold-critical':\n        this.energyData.threshold_critical = parseFloat(newValue) || 90;\n        this.render();\n        break;\n      case 'ws-url':\n        this.config.wsUrl = newValue;\n        if (newValue) {\n          this.connectWebSocket();\n        }\n        break;\n      case 'auto-connect':\n        // Auto-connect handled by ws-url attribute\n        break;\n    }\n  }\n}\n\n// Register custom element\nif (!customElements.get('iv-energy-gauge')) {\n  customElements.define('iv-energy-gauge', IVEnergyGauge);\n}\n"]}