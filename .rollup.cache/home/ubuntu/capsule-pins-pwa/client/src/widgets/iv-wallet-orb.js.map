{"version":3,"file":"iv-wallet-orb.js","sourceRoot":"","sources":["iv-wallet-orb.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * <iv-wallet-orb> Widget\n * Week 8: White-Label Platform\n * \n * Visual representation of wallet balance with AmI glow effects\n * \n * Usage:\n * <iv-wallet-orb\n *   balance=\"1250.50\"\n *   currency=\"USD\"\n *   ws-url=\"wss://api.industriverse.io/ws\"\n *   user-id=\"user123\"\n * ></iv-wallet-orb>\n */\n\nimport { IVWidget } from './base/IVWidget';\n\nexport class IVWalletOrb extends IVWidget {\n  private balance: number = 0;\n  private currency: string = 'USD';\n  private isAnimating: boolean = false;\n\n  static get observedAttributes() {\n    return ['balance', 'currency'];\n  }\n\n  protected handleAttributeChange(name: string, oldValue: string, newValue: string): void {\n    if (name === 'balance') {\n      const newBalance = parseFloat(newValue) || 0;\n      if (newBalance !== this.balance) {\n        this.animateBalanceChange(this.balance, newBalance);\n        this.balance = newBalance;\n      }\n    } else if (name === 'currency') {\n      this.currency = newValue || 'USD';\n    }\n  }\n\n  protected shouldRerender(attributeName: string): boolean {\n    return attributeName === 'currency';\n  }\n\n  protected render(): void {\n    // Clear shadow DOM\n    this.shadow.innerHTML = '';\n\n    // Apply styles\n    this.applyStyles(this.getStyles());\n\n    // Create structure\n    const container = document.createElement('div');\n    container.className = 'wallet-orb-container';\n\n    const orb = document.createElement('div');\n    orb.className = 'orb';\n    orb.id = 'orb';\n\n    const balanceEl = document.createElement('div');\n    balanceEl.className = 'balance';\n    balanceEl.id = 'balance';\n    balanceEl.textContent = this.formatBalance(this.balance);\n\n    const currencyEl = document.createElement('div');\n    currencyEl.className = 'currency';\n    currencyEl.textContent = this.currency;\n\n    orb.appendChild(balanceEl);\n    orb.appendChild(currencyEl);\n    container.appendChild(orb);\n\n    this.shadow.appendChild(container);\n  }\n\n  protected attachEventListeners(): void {\n    // Click to pulse animation\n    const orb = this.shadow.getElementById('orb');\n    if (orb) {\n      orb.addEventListener('click', () => {\n        this.pulseAnimation();\n      });\n    }\n  }\n\n  protected onWebSocketMessage(event: MessageEvent): void {\n    try {\n      const data = JSON.parse(event.data);\n      \n      if (data.type === 'balance_update' && data.userId === this.config.userId) {\n        this.updateBalance(data.balance);\n      }\n    } catch (error) {\n      console.error('Failed to parse WebSocket message:', error);\n    }\n  }\n\n  private updateBalance(newBalance: number): void {\n    this.setAttribute('balance', newBalance.toString());\n  }\n\n  private formatBalance(balance: number): string {\n    return new Intl.NumberFormat('en-US', {\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 2,\n    }).format(balance);\n  }\n\n  private animateBalanceChange(oldBalance: number, newBalance: number): void {\n    if (this.isAnimating) return;\n    \n    this.isAnimating = true;\n    const balanceEl = this.shadow.getElementById('balance');\n    const orb = this.shadow.getElementById('orb');\n    \n    if (!balanceEl || !orb) return;\n\n    const duration = 1000; // 1 second\n    const startTime = Date.now();\n    const diff = newBalance - oldBalance;\n\n    const animate = () => {\n      const elapsed = Date.now() - startTime;\n      const progress = Math.min(elapsed / duration, 1);\n      \n      // Ease out cubic\n      const eased = 1 - Math.pow(1 - progress, 3);\n      const currentBalance = oldBalance + (diff * eased);\n      \n      balanceEl.textContent = this.formatBalance(currentBalance);\n\n      // Add glow effect based on change direction\n      if (diff > 0) {\n        orb.style.boxShadow = `0 0 ${20 + (progress * 30)}px ${this.theme.statusSuccess}`;\n      } else if (diff < 0) {\n        orb.style.boxShadow = `0 0 ${20 + (progress * 30)}px ${this.theme.statusError}`;\n      }\n\n      if (progress < 1) {\n        requestAnimationFrame(animate);\n      } else {\n        this.isAnimating = false;\n        // Reset to default glow\n        setTimeout(() => {\n          orb.style.boxShadow = `0 0 30px ${this.theme.amiContextGlow}`;\n        }, 500);\n      }\n    };\n\n    requestAnimationFrame(animate);\n  }\n\n  private pulseAnimation(): void {\n    const orb = this.shadow.getElementById('orb');\n    if (!orb) return;\n\n    orb.style.animation = 'none';\n    setTimeout(() => {\n      orb.style.animation = 'pulse 0.5s ease-out';\n    }, 10);\n  }\n\n  private getStyles(): string {\n    return `\n      :host {\n        display: inline-block;\n        --orb-size: 120px;\n      }\n\n      .wallet-orb-container {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        padding: 1rem;\n      }\n\n      .orb {\n        width: var(--orb-size);\n        height: var(--orb-size);\n        border-radius: 50%;\n        background: linear-gradient(135deg, ${this.theme.brandPrimary}, ${this.theme.brandSecondary});\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        justify-content: center;\n        cursor: pointer;\n        transition: transform ${this.theme.durationNormal} ${this.theme.easingDefault};\n        box-shadow: 0 0 30px ${this.theme.amiContextGlow};\n        position: relative;\n        overflow: hidden;\n      }\n\n      .orb::before {\n        content: '';\n        position: absolute;\n        top: -50%;\n        left: -50%;\n        width: 200%;\n        height: 200%;\n        background: radial-gradient(circle, ${this.theme.amiPredictionPulse} 0%, transparent 70%);\n        animation: rotate 10s linear infinite;\n      }\n\n      .orb:hover {\n        transform: scale(1.05);\n      }\n\n      .orb:active {\n        transform: scale(0.95);\n      }\n\n      .balance {\n        font-family: ${this.theme.fontMono};\n        font-size: 1.25rem;\n        font-weight: 700;\n        color: ${this.theme.fgPrimary};\n        z-index: 1;\n        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);\n      }\n\n      .currency {\n        font-family: ${this.theme.fontBody};\n        font-size: 0.75rem;\n        font-weight: 500;\n        color: ${this.theme.fgSecondary};\n        z-index: 1;\n        text-transform: uppercase;\n        letter-spacing: 0.1em;\n        margin-top: 0.25rem;\n      }\n\n      @keyframes rotate {\n        from {\n          transform: rotate(0deg);\n        }\n        to {\n          transform: rotate(360deg);\n        }\n      }\n\n      @keyframes pulse {\n        0%, 100% {\n          transform: scale(1);\n        }\n        50% {\n          transform: scale(1.1);\n        }\n      }\n    `;\n  }\n}\n\n// Register custom element\nif (!customElements.get('iv-wallet-orb')) {\n  customElements.define('iv-wallet-orb', IVWalletOrb);\n}\n"]}