{"version":3,"file":"IVWidget.js","sourceRoot":"","sources":["IVWidget.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * IVWidget Base Class\n * Week 8: White-Label Platform - Widget Architecture\n * \n * Base class for all <iv-*> custom elements\n * Provides theme integration, WebSocket support, and lifecycle management\n */\n\nexport interface IVWidgetConfig {\n  apiUrl?: string;\n  wsUrl?: string;\n  userId?: string;\n  themeMode?: string;\n  autoConnect?: boolean;\n}\n\nexport abstract class IVWidget extends HTMLElement {\n  protected shadow: ShadowRoot;\n  protected theme: Record<string, string> = {};\n  protected ws: WebSocket | null = null;\n  protected config: IVWidgetConfig = {};\n  protected wsConnected: boolean = false;\n\n  constructor() {\n    super();\n    this.shadow = this.attachShadow({ mode: 'open' });\n  }\n\n  /**\n   * Lifecycle: Element added to DOM\n   */\n  connectedCallback() {\n    this.loadConfig();\n    this.loadTheme();\n    this.render();\n    this.attachEventListeners();\n    \n    if (this.config.autoConnect !== false && this.config.wsUrl) {\n      this.connectWebSocket();\n    }\n  }\n\n  /**\n   * Lifecycle: Element removed from DOM\n   */\n  disconnectedCallback() {\n    this.disconnectWebSocket();\n    this.cleanup();\n  }\n\n  /**\n   * Lifecycle: Attribute changed\n   */\n  attributeChangedCallback(name: string, oldValue: string, newValue: string) {\n    if (oldValue === newValue) return;\n    \n    this.handleAttributeChange(name, oldValue, newValue);\n    \n    // Re-render if significant attribute changed\n    if (this.shouldRerender(name)) {\n      this.render();\n    }\n  }\n\n  /**\n   * Load configuration from attributes\n   */\n  protected loadConfig(): void {\n    this.config = {\n      apiUrl: this.getAttribute('api-url') || undefined,\n      wsUrl: this.getAttribute('ws-url') || undefined,\n      userId: this.getAttribute('user-id') || undefined,\n      themeMode: this.getAttribute('theme-mode') || undefined,\n      autoConnect: this.getAttribute('auto-connect') !== 'false',\n    };\n  }\n\n  /**\n   * Load theme from CSS custom properties\n   */\n  protected loadTheme(): void {\n    const computedStyle = getComputedStyle(document.documentElement);\n    \n    this.theme = {\n      // Brand colors\n      brandPrimary: computedStyle.getPropertyValue('--brand-primary').trim() || '#0ea5e9',\n      brandSecondary: computedStyle.getPropertyValue('--brand-secondary').trim() || '#8b5cf6',\n      brandAccent: computedStyle.getPropertyValue('--brand-accent').trim() || '#f59e0b',\n      \n      // Status colors\n      statusSuccess: computedStyle.getPropertyValue('--status-success').trim() || '#10b981',\n      statusWarning: computedStyle.getPropertyValue('--status-warning').trim() || '#f59e0b',\n      statusError: computedStyle.getPropertyValue('--status-error').trim() || '#ef4444',\n      statusInfo: computedStyle.getPropertyValue('--status-info').trim() || '#3b82f6',\n      \n      // Semantic colors\n      bgPrimary: computedStyle.getPropertyValue('--bg-primary').trim() || '#0f172a',\n      bgSecondary: computedStyle.getPropertyValue('--bg-secondary').trim() || '#1e293b',\n      fgPrimary: computedStyle.getPropertyValue('--fg-primary').trim() || '#f8fafc',\n      fgSecondary: computedStyle.getPropertyValue('--fg-secondary').trim() || '#cbd5e1',\n      borderDefault: computedStyle.getPropertyValue('--border-default').trim() || '#334155',\n      \n      // AmI colors\n      amiContextGlow: computedStyle.getPropertyValue('--ami-context-glow').trim() || 'rgba(14, 165, 233, 0.3)',\n      amiPredictionPulse: computedStyle.getPropertyValue('--ami-prediction-pulse').trim() || 'rgba(139, 92, 246, 0.4)',\n      amiAdaptationFade: computedStyle.getPropertyValue('--ami-adaptation-fade').trim() || 'rgba(245, 158, 11, 0.2)',\n      \n      // Typography\n      fontHeading: computedStyle.getPropertyValue('--font-heading').trim() || \"'Inter', sans-serif\",\n      fontBody: computedStyle.getPropertyValue('--font-body').trim() || \"'Inter', sans-serif\",\n      fontMono: computedStyle.getPropertyValue('--font-mono').trim() || \"'JetBrains Mono', monospace\",\n      \n      // Effects\n      radiusMd: computedStyle.getPropertyValue('--radius-md').trim() || '0.5rem',\n      shadowMd: computedStyle.getPropertyValue('--shadow-md').trim() || '0 4px 6px -1px rgb(0 0 0 / 0.1)',\n      \n      // Animations\n      durationNormal: computedStyle.getPropertyValue('--duration-normal').trim() || '300ms',\n      easingDefault: computedStyle.getPropertyValue('--easing-default').trim() || 'cubic-bezier(0.4, 0, 0.2, 1)',\n    };\n  }\n\n  /**\n   * Connect to WebSocket\n   */\n  protected connectWebSocket(): void {\n    if (!this.config.wsUrl) return;\n    \n    try {\n      this.ws = new WebSocket(this.config.wsUrl);\n      \n      this.ws.onopen = () => {\n        this.wsConnected = true;\n        this.onWebSocketOpen();\n      };\n      \n      this.ws.onmessage = (event) => {\n        this.onWebSocketMessage(event);\n      };\n      \n      this.ws.onerror = (error) => {\n        this.onWebSocketError(error);\n      };\n      \n      this.ws.onclose = () => {\n        this.wsConnected = false;\n        this.onWebSocketClose();\n      };\n    } catch (error) {\n      console.error('Failed to connect WebSocket:', error);\n    }\n  }\n\n  /**\n   * Disconnect from WebSocket\n   */\n  protected disconnectWebSocket(): void {\n    if (this.ws) {\n      this.ws.close();\n      this.ws = null;\n      this.wsConnected = false;\n    }\n  }\n\n  /**\n   * Send message via WebSocket\n   */\n  protected sendWebSocketMessage(data: any): void {\n    if (this.ws && this.wsConnected) {\n      this.ws.send(JSON.stringify(data));\n    }\n  }\n\n  /**\n   * Apply styles to shadow DOM\n   */\n  protected applyStyles(styles: string): void {\n    const styleEl = document.createElement('style');\n    styleEl.textContent = styles;\n    this.shadow.appendChild(styleEl);\n  }\n\n  /**\n   * Emit custom event\n   */\n  protected emitEvent(name: string, detail?: any): void {\n    this.dispatchEvent(new CustomEvent(name, {\n      detail,\n      bubbles: true,\n      composed: true,\n    }));\n  }\n\n  // Abstract methods to be implemented by subclasses\n  protected abstract render(): void;\n  protected abstract attachEventListeners(): void;\n  \n  // Optional lifecycle hooks\n  protected handleAttributeChange(name: string, oldValue: string, newValue: string): void {}\n  protected shouldRerender(attributeName: string): boolean { return false; }\n  protected onWebSocketOpen(): void {}\n  protected onWebSocketMessage(event: MessageEvent): void {}\n  protected onWebSocketError(error: Event): void {}\n  protected onWebSocketClose(): void {}\n  protected cleanup(): void {}\n}\n"]}