{"version":3,"file":"iv-shadow-twin.js","sourceRoot":"","sources":["iv-shadow-twin.ts"],"names":[],"mappings":";AAAA,OAAO,EAAE,QAAQ,EAAE,MAAM,iBAAiB,CAAC;AAW3C;IAAkC,gCAAQ;IAexC;QACE,YAAA,MAAK,WAAE,SAAC;QAVA,cAAQ,GAAmB;YACnC,MAAM,EAAE,EAAE;YACV,UAAU,EAAE,SAAS;YACrB,QAAQ,EAAE,CAAC;YACX,eAAe,EAAE,CAAC;YAClB,iBAAiB,EAAE,CAAC;YACpB,iBAAiB,EAAE,KAAK;SACzB,CAAC;;IAIF,CAAC;IAhBS,2CAAoB,GAA9B;QAAA,iBAGC;;QAFC,IAAM,OAAO,GAAG,MAAA,IAAI,CAAC,UAAU,0CAAE,aAAa,CAAC,WAAW,CAAC,CAAC;QAC5D,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,gBAAgB,CAAC,OAAO,EAAE,cAAM,OAAA,KAAI,CAAC,SAAS,EAAE,EAAhB,CAAgB,CAAC,CAAC;IAC7D,CAAC;IAeS,uCAAgB,GAA1B;QACE,OAAO,+DAA+D,CAAC;IACzE,CAAC;IAES,6BAAM,GAAhB;QACE,IAAI,CAAC,IAAI,CAAC,UAAU;YAAE,OAAO;QAC7B,IAAM,MAAM,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;QACvC,IAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,IAAI,SAAS,CAAC;QACjD,IAAI,CAAC,UAAU,CAAC,SAAS,GAAG,SAAS,GAAG,MAAM,GAAG,4BAA4B,GAAG,MAAM,GAAG,8CAA8C,CAAC;QACxI,IAAI,CAAC,oBAAoB,EAAE,CAAC;IAC9B,CAAC;IAES,gCAAS,GAAnB;QACE,IAAI,CAAC,SAAS,CAAC,gBAAgB,EAAE,EAAE,MAAM,EAAE,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAC;IACrE,CAAC;IAES,6CAAsB,GAAhC,UAAiC,IAAS;QACxC,IAAI,IAAI,CAAC,IAAI,KAAK,aAAa,EAAE,CAAC;YAChC,IAAI,CAAC,QAAQ,yBAAQ,IAAI,CAAC,QAAQ,GAAK,IAAI,CAAC,IAAI,CAAE,CAAC;YACnD,IAAI,CAAC,MAAM,EAAE,CAAC;QAChB,CAAC;IACH,CAAC;IAES,gCAAS,GAAnB;QACE,IAAI,CAAC,MAAM,EAAE,CAAC;IAChB,CAAC;IAES,mCAAY,GAAtB,cAAgC,CAAC;IAEjC,sBAAW,kCAAkB;aAA7B;YACE,OAAO,CAAC,SAAS,EAAE,aAAa,EAAE,QAAQ,CAAC,CAAC;QAC9C,CAAC;;;OAAA;IAED,+CAAwB,GAAxB,UAAyB,IAAY,EAAE,QAAgB,EAAE,QAAgB;QACvE,IAAI,QAAQ,KAAK,QAAQ;YAAE,OAAO;QAClC,IAAI,IAAI,KAAK,SAAS,EAAE,CAAC;YACvB,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,QAAQ,CAAC;YAChC,IAAI,CAAC,MAAM,EAAE,CAAC;QAChB,CAAC;IACH,CAAC;IACH,mBAAC;AAAD,CAAC,AA3DD,CAAkC,QAAQ,GA2DzC;;AAED,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,gBAAgB,CAAC,EAAE,CAAC;IAC1C,cAAc,CAAC,MAAM,CAAC,gBAAgB,EAAE,YAAY,CAAC,CAAC;AACxD,CAAC","sourcesContent":["import { IVWidget } from './base/IVWidget';\n\ninterface ShadowTwinData {\n  twinId: string;\n  syncStatus: 'synced' | 'syncing' | 'drift' | 'offline';\n  lastSync: number;\n  driftPercentage: number;\n  energyConsumption: number;\n  calibrationNeeded: boolean;\n}\n\nexport class IVShadowTwin extends IVWidget {\n  protected attachEventListeners(): void {\n    const syncBtn = this.shadowRoot?.querySelector('.sync-btn');\n    syncBtn?.addEventListener('click', () => this.forceSync());\n  }\n\n  protected twinData: ShadowTwinData = {\n    twinId: '',\n    syncStatus: 'offline',\n    lastSync: 0,\n    driftPercentage: 0,\n    energyConsumption: 0,\n    calibrationNeeded: false,\n  };\n\n  constructor() {\n    super();\n  }\n\n  protected getDefaultStyles(): string {\n    return ':host { display: block; font-family: system-ui, sans-serif; }';\n  }\n\n  protected render(): void {\n    if (!this.shadowRoot) return;\n    const styles = this.getDefaultStyles();\n    const twinId = this.twinData.twinId || 'Unknown';\n    this.shadowRoot.innerHTML = '<style>' + styles + '</style><div>Shadow Twin: ' + twinId + '</div><button class=\"sync-btn\">Sync</button>';\n    this.attachEventListeners();\n  }\n\n  protected forceSync(): void {\n    this.emitEvent('sync-requested', { twinId: this.twinData.twinId });\n  }\n\n  protected handleWebSocketMessage(data: any): void {\n    if (data.type === 'twin_update') {\n      this.twinData = { ...this.twinData, ...data.data };\n      this.render();\n    }\n  }\n\n  protected onConnect(): void {\n    this.render();\n  }\n\n  protected onDisconnect(): void {}\n\n  static get observedAttributes() {\n    return ['twin-id', 'sync-status', 'ws-url'];\n  }\n\n  attributeChangedCallback(name: string, oldValue: string, newValue: string) {\n    if (oldValue === newValue) return;\n    if (name === 'twin-id') {\n      this.twinData.twinId = newValue;\n      this.render();\n    }\n  }\n}\n\nif (!customElements.get('iv-shadow-twin')) {\n  customElements.define('iv-shadow-twin', IVShadowTwin);\n}\n"]}