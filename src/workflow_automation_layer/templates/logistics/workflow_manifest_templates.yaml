# Logistics Industry Workflow Manifest Templates
# These templates define common workflow patterns for logistics operations

---
# Supply Chain Visibility Workflow
name: supply_chain_visibility
version: "1.0"
description: "Workflow for end-to-end supply chain visibility and tracking"
industry: "logistics"
category: "tracking"
execution_modes:
  - name: "reactive"
    description: "Triggered by supply chain events"
    trust_threshold: 0.6
    confidence_required: 0.7
    human_oversight: true
  - name: "proactive"
    description: "Continuous supply chain monitoring"
    trust_threshold: 0.75
    confidence_required: 0.8
    human_oversight: true
  - name: "autonomous"
    description: "Fully automated supply chain tracking"
    trust_threshold: 0.9
    confidence_required: 0.95
    human_oversight: false
mesh_topology:
  edge_capable: true
  cloud_fallback: true
  data_locality: "distributed"
  routing_constraints:
    - "location_data_privacy"
    - "cross_border_compliance"
debug_trace:
  enabled: true
  detail_level: "comprehensive"
  retention_period_days: 90
  pattern_recognition: true
tasks:
  - id: "shipment_tracking"
    name: "Track Shipment Location"
    description: "Track real-time location of shipments"
    timeout_seconds: 300
    retry_count: 3
    inputs:
      - name: "shipment_id"
        type: "string"
        required: true
      - name: "tracking_method"
        type: "string"
        required: true
    outputs:
      - name: "location_data"
        type: "object"
        description: "Current location and status data"
    contract:
      verification_method: "schema_validation"
      schema_ref: "logistics/schemas/location_data.json"
  
  - id: "eta_calculation"
    name: "Calculate ETA"
    description: "Calculate estimated time of arrival based on current conditions"
    timeout_seconds: 600
    inputs:
      - name: "location_data"
        type: "object"
        required: true
      - name: "destination"
        type: "object"
        required: true
      - name: "route_data"
        type: "object"
        required: true
    outputs:
      - name: "eta"
        type: "string"
        description: "Estimated time of arrival"
      - name: "confidence_score"
        type: "number"
        description: "Confidence score for the ETA"
    contract:
      verification_method: "ml_validation"
      model_ref: "logistics/models/eta_prediction.onnx"
  
  - id: "delay_detection"
    name: "Detect Delays"
    description: "Detect potential delays in the supply chain"
    timeout_seconds: 300
    inputs:
      - name: "location_data"
        type: "object"
        required: true
      - name: "eta"
        type: "string"
        required: true
      - name: "schedule"
        type: "object"
        required: true
    outputs:
      - name: "delay_detected"
        type: "boolean"
        description: "Whether a delay is detected"
      - name: "delay_details"
        type: "object"
        description: "Details about the detected delay"
    contract:
      verification_method: "rule_validation"
      rules_ref: "logistics/rules/delay_detection.json"
  
  - id: "impact_analysis"
    name: "Analyze Impact"
    description: "Analyze the impact of delays on the supply chain"
    timeout_seconds: 600
    inputs:
      - name: "delay_details"
        type: "object"
        required: true
      - name: "supply_chain_data"
        type: "object"
        required: true
    outputs:
      - name: "impact_assessment"
        type: "object"
        description: "Assessment of the delay impact"
      - name: "affected_entities"
        type: "array"
        description: "Entities affected by the delay"
    contract:
      verification_method: "ml_validation"
      model_ref: "logistics/models/impact_analysis.onnx"
  
  - id: "mitigation_planning"
    name: "Plan Mitigation"
    description: "Plan mitigation actions for supply chain disruptions"
    timeout_seconds: 900
    inputs:
      - name: "impact_assessment"
        type: "object"
        required: true
      - name: "affected_entities"
        type: "array"
        required: true
      - name: "available_resources"
        type: "object"
        required: true
    outputs:
      - name: "mitigation_plan"
        type: "object"
        description: "Plan for mitigating the disruption"
      - name: "required_actions"
        type: "array"
        description: "Actions required for mitigation"
    contract:
      verification_method: "constraint_satisfaction"
      constraints_ref: "logistics/constraints/mitigation_planning.json"
  
  - id: "human_approval"
    name: "Get Human Approval"
    description: "Request approval for critical mitigation actions"
    timeout_seconds: 3600
    human_in_loop: true
    inputs:
      - name: "mitigation_plan"
        type: "object"
        required: true
      - name: "impact_assessment"
        type: "object"
        required: true
    outputs:
      - name: "approval_status"
        type: "string"
        description: "Approval status (approved, rejected, modified)"
      - name: "modified_plan"
        type: "object"
        description: "Modified mitigation plan if applicable"
    contract:
      verification_method: "human_verification"
      verification_ui: "logistics/ui/mitigation_approval.json"
  
  - id: "notification"
    name: "Send Notifications"
    description: "Notify stakeholders about supply chain disruptions"
    timeout_seconds: 300
    inputs:
      - name: "affected_entities"
        type: "array"
        required: true
      - name: "impact_assessment"
        type: "object"
        required: true
      - name: "mitigation_plan"
        type: "object"
        required: true
    outputs:
      - name: "notification_status"
        type: "object"
        description: "Status of sent notifications"
    contract:
      verification_method: "schema_validation"
      schema_ref: "logistics/schemas/notification.json"
  
  - id: "action_execution"
    name: "Execute Mitigation Actions"
    description: "Execute and track mitigation actions"
    timeout_seconds: 7200
    inputs:
      - name: "mitigation_plan"
        type: "object"
        required: true
      - name: "required_actions"
        type: "array"
        required: true
    outputs:
      - name: "execution_status"
        type: "object"
        description: "Status of action execution"
      - name: "action_results"
        type: "array"
        description: "Results of executed actions"
    contract:
      verification_method: "schema_validation"
      schema_ref: "logistics/schemas/action_execution.json"
  
  - id: "rerouting"
    name: "Reroute Shipments"
    description: "Reroute shipments to avoid disruptions"
    timeout_seconds: 900
    inputs:
      - name: "shipment_id"
        type: "string"
        required: true
      - name: "current_route"
        type: "object"
        required: true
      - name: "disruption_data"
        type: "object"
        required: true
    outputs:
      - name: "new_route"
        type: "object"
        description: "New optimized route"
      - name: "new_eta"
        type: "string"
        description: "Updated estimated time of arrival"
    contract:
      verification_method: "constraint_satisfaction"
      constraints_ref: "logistics/constraints/routing_optimization.json"
  
  - id: "documentation"
    name: "Update Documentation"
    description: "Update supply chain documentation and records"
    timeout_seconds: 300
    inputs:
      - name: "shipment_id"
        type: "string"
        required: true
      - name: "delay_details"
        type: "object"
        required: true
      - name: "mitigation_plan"
        type: "object"
        required: true
      - name: "action_results"
        type: "array"
        required: true
    outputs:
      - name: "documentation_status"
        type: "string"
        description: "Status of documentation update"
    contract:
      verification_method: "schema_validation"
      schema_ref: "logistics/schemas/documentation.json"

workflow:
  start: "shipment_tracking"
  transitions:
    - from: "shipment_tracking"
      to: "eta_calculation"
      condition: "success"
    - from: "eta_calculation"
      to: "delay_detection"
      condition: "success"
    - from: "delay_detection"
      to: "impact_analysis"
      condition: "delay_detected == true"
    - from: "delay_detection"
      to: "shipment_tracking"
      condition: "delay_detected == false"
      wait_seconds: 1800
    - from: "impact_analysis"
      to: "mitigation_planning"
      condition: "success"
    - from: "mitigation_planning"
      to: "human_approval"
      condition: "impact_assessment.severity == 'high' || impact_assessment.severity == 'critical'"
    - from: "mitigation_planning"
      to: "notification"
      condition: "impact_assessment.severity == 'low' || impact_assessment.severity == 'medium'"
    - from: "human_approval"
      to: "notification"
      condition: "approval_status == 'approved' || approval_status == 'modified'"
    - from: "human_approval"
      to: "mitigation_planning"
      condition: "approval_status == 'rejected'"
    - from: "notification"
      to: "action_execution"
      condition: "success"
    - from: "action_execution"
      to: "rerouting"
      condition: "required_actions.some(a => a.type == 'reroute')"
    - from: "action_execution"
      to: "documentation"
      condition: "!required_actions.some(a => a.type == 'reroute')"
    - from: "rerouting"
      to: "documentation"
      condition: "success"
    - from: "documentation"
      to: "shipment_tracking"
      condition: "success"
      wait_seconds: 3600

escalation:
  policies:
    - trigger: "task_timeout"
      action: "notify_logistics_manager"
      priority: "high"
    - trigger: "task_failure"
      action: "retry_then_escalate"
      retry_count: 3
      priority: "medium"
    - trigger: "contract_violation"
      action: "notify_logistics_engineer"
      priority: "critical"
    - trigger: "human_approval_timeout"
      action: "notify_operations_director"
      priority: "high"
    - trigger: "critical_delay_detected"
      action: "emergency_response_team"
      priority: "critical"

dtsl_embedding:
  enabled: true
  twin_source: "shipment_digital_twin"
  edge_execution: true
  twin_capabilities:
    - "location_tracking"
    - "condition_monitoring"
    - "local_route_optimization"
  synchronization:
    mode: "eventual_consistency"
    priority_events:
      - "critical_delay_detected"
      - "route_changed"
      - "condition_alert"

---
# Warehouse Optimization Workflow
name: warehouse_optimization
version: "1.0"
description: "Workflow for optimizing warehouse operations and inventory management"
industry: "logistics"
category: "warehouse"
execution_modes:
  - name: "reactive"
    description: "Triggered by inventory events"
    trust_threshold: 0.7
    confidence_required: 0.8
    human_oversight: true
  - name: "proactive"
    description: "Scheduled warehouse optimization"
    trust_threshold: 0.8
    confidence_required: 0.85
    human_oversight: true
  - name: "autonomous"
    description: "Fully automated warehouse management"
    trust_threshold: 0.95
    confidence_required: 0.98
    human_oversight: false
mesh_topology:
  edge_capable: true
  cloud_fallback: true
  data_locality: "edge_preferred"
  routing_constraints:
    - "inventory_data_local_only"
    - "real_time_edge_only"
debug_trace:
  enabled: true
  detail_level: "comprehensive"
  retention_period_days: 90
  pattern_recognition: true
tasks:
  - id: "inventory_analysis"
    name: "Analyze Inventory Levels"
    description: "Analyze current inventory levels and movement patterns"
    timeout_seconds: 600
    retry_count: 3
    inputs:
      - name: "warehouse_id"
        type: "string"
        required: true
      - name: "time_period"
        type: "string"
        required: true
    outputs:
      - name: "inventory_analysis"
        type: "object"
        description: "Analysis of inventory levels and patterns"
    contract:
      verification_method: "schema_validation"
      schema_ref: "logistics/schemas/inventory_analysis.json"
  
  - id: "demand_forecasting"
    name: "Forecast Demand"
    description: "Forecast future demand for inventory planning"
    timeout_seconds: 900
    inputs:
      - name: "inventory_analysis"
        type: "object"
        required: true
      - name: "historical_data"
        type: "object"
        required: true
      - name: "market_factors"
        type: "object"
        required: false
    outputs:
      - name: "demand_forecast"
        type: "object"
        description: "Forecasted demand for products"
      - name: "confidence_intervals"
        type: "object"
        description: "Confidence intervals for the forecast"
    contract:
      verification_method: "ml_validation"
      model_ref: "logistics/models/demand_forecasting.onnx"
  
  - id: "layout_optimization"
    name: "Optimize Warehouse Layout"
    description: "Optimize warehouse layout based on inventory and demand patterns"
    timeout_seconds: 1800
    inputs:
      - name: "inventory_analysis"
        type: "object"
        required: true
      - name: "demand_forecast"
        type: "object"
        required: true
      - name: "warehouse_constraints"
        type: "object"
        required: true
    outputs:
      - name: "optimized_layout"
        type: "object"
        description: "Optimized warehouse layout"
      - name: "expected_improvements"
        type: "object"
        description: "Expected improvements from layout changes"
    contract:
      verification_method: "constraint_satisfaction"
      constraints_ref: "logistics/constraints/layout_optimization.json"
  
  - id: "picking_route_optimization"
    name: "Optimize Picking Routes"
    description: "Optimize picking routes for warehouse workers"
    timeout_seconds: 600
    inputs:
      - name: "optimized_layout"
        type: "object"
        required: true
      - name: "order_batch"
        type: "array"
        required: true
      - name: "worker_constraints"
        type: "object"
        required: false
    outputs:
      - name: "optimized_routes"
        type: "array"
        description: "Optimized picking routes"
      - name: "estimated_time"
        type: "object"
        description: "Estimated time for picking"
    contract:
      verification_method: "constraint_satisfaction"
      constraints_ref: "logistics/constraints/route_optimization.json"
  
  - id: "human_review"
    name: "Human Review"
    description: "Request human review for major layout changes"
    timeout_seconds: 3600
    human_in_loop: true
    inputs:
      - name: "optimized_layout"
        type: "object"
        required: true
      - name: "expected_improvements"
        type: "object"
        required: true
      - name: "current_layout"
        type: "object"
        required: true
    outputs:
      - name: "review_status"
        type: "string"
        description: "Review status (approved, rejected, modified)"
      - name: "modified_layout"
        type: "object"
        description: "Modified layout if applicable"
    contract:
      verification_method: "human_verification"
      verification_ui: "logistics/ui/layout_review.json"
  
  - id: "implementation_planning"
    name: "Plan Implementation"
    description: "Plan implementation of layout changes"
    timeout_seconds: 900
    inputs:
      - name: "optimized_layout"
        type: "object"
        required: true
      - name: "current_layout"
        type: "object"
        required: true
      - name: "warehouse_schedule"
        type: "object"
        required: true
    outputs:
      - name: "implementation_plan"
        type: "object"
        description: "Plan for implementing layout changes"
      - name: "resource_requirements"
        type: "object"
        description: "Resources required for implementation"
    contract:
      verification_method: "schema_validation"
      schema_ref: "logistics/schemas/implementation_plan.json"
  
  - id: "notification"
    name: "Send Notifications"
    description: "Notify warehouse staff about layout changes"
    timeout_seconds: 300
    inputs:
      - name: "implementation_plan"
        type: "object"
        required: true
      - name: "affected_staff"
        type: "array"
        required: true
    outputs:
      - name: "notification_status"
        type: "object"
        description: "Status of sent notifications"
    contract:
      verification_method: "schema_validation"
      schema_ref: "logistics/schemas/notification.json"
  
  - id: "implementation_tracking"
    name: "Track Implementation"
    description: "Track implementation of layout changes"
    timeout_seconds: 7200
    inputs:
      - name: "implementation_plan"
        type: "object"
        required: true
      - name: "resource_requirements"
        type: "object"
        required: true
    outputs:
      - name: "implementation_status"
        type: "object"
        description: "Status of implementation"
      - name: "completion_report"
        type: "object"
        description: "Implementation completion report"
    contract:
      verification_method: "schema_validation"
      schema_ref: "logistics/schemas/implementation_status.json"
  
  - id: "performance_measurement"
    name: "Measure Performance"
    description: "Measure performance improvements from layout changes"
    timeout_seconds: 1800
    inputs:
      - name: "warehouse_id"
        type: "string"
        required: true
      - name: "before_metrics"
        type: "object"
        required: true
      - name: "implementation_status"
        type: "object"
        required: true
    outputs:
      - name: "performance_metrics"
        type: "object"
        description: "Performance metrics after changes"
      - name: "improvement_analysis"
        type: "object"
        description: "Analysis of improvements"
    contract:
      verification_method: "schema_validation"
      schema_ref: "logistics/schemas/performance_metrics.json"
  
  - id: "documentation"
    name: "Update Documentation"
    description: "Update warehouse documentation and records"
    timeout_seconds: 300
    inputs:
      - name: "warehouse_id"
        type: "string"
        required: true
      - name: "optimized_layout"
        type: "object"
        required: true
      - name: "implementation_status"
        type: "object"
        required: true
      - name: "performance_metrics"
        type: "object"
        required: true
    outputs:
      - name: "documentation_status"
        type: "string"
        description: "Status of documentation update"
    contract:
      verification_method: "schema_validation"
      schema_ref: "logistics/schemas/documentation.json"

workflow:
  start: "inventory_analysis"
  transitions:
    - from: "inventory_analysis"
      to: "demand_forecasting"
      condition: "success"
    - from: "demand_forecasting"
      to: "layout_optimization"
      condition: "success"
    - from: "layout_optimization"
      to: "human_review"
      condition: "expected_improvements.efficiency_gain > 10"
    - from: "layout_optimization"
      to: "picking_route_optimization"
      condition: "expected_improvements.efficiency_gain <= 10"
    - from: "human_review"
      to: "picking_route_optimization"
      condition: "review_status == 'approved' || review_status == 'modified'"
    - from: "human_review"
      to: "layout_optimization"
      condition: "review_status == 'rejected'"
    - from: "picking_route_optimization"
      to: "implementation_planning"
      condition: "success"
    - from: "implementation_planning"
      to: "notification"
      condition: "success"
    - from: "notification"
      to: "implementation_tracking"
      condition: "success"
    - from: "implementation_tracking"
      to: "performance_measurement"
      condition: "implementation_status.completed == true"
    - from: "performance_measurement"
      to: "documentation"
      condition: "success"

escalation:
  policies:
    - trigger: "task_timeout"
      action: "notify_warehouse_manager"
      priority: "high"
    - trigger: "task_failure"
      action: "retry_then_escalate"
      retry_count: 3
      priority: "medium"
    - trigger: "contract_violation"
      action: "notify_operations_engineer"
      priority: "critical"
    - trigger: "human_review_timeout"
      action: "notify_operations_director"
      priority: "high"

dtsl_embedding:
  enabled: true
  twin_source: "warehouse_digital_twin"
  edge_execution: true
  twin_capabilities:
    - "inventory_tracking"
    - "layout_visualization"
    - "worker_route_optimization"
  synchronization:
    mode: "eventual_consistency"
    priority_events:
      - "layout_changed"
      - "inventory_threshold_alert"
      - "picking_efficiency_alert"
